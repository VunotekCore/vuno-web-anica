---
// Contact form component with two options: Quote Project or Schedule Meeting
---

<section class="mx-auto max-w-4xl">
    <div class="rounded-lg border-2 border-primary/30 bg-gray-50 p-8 shadow-xl">
        <!-- Form Type Selector -->
        <div class="mb-8 flex gap-4">
            <button
                type="button"
                id="btn-cotizar"
                class="form-type-btn active hover:bg-primary/90 flex-1 rounded-lg border-2 border-primary bg-primary px-6 py-3 font-bold text-white transition-all"
            >
                Cotizar Proyecto
            </button>
            <button
                type="button"
                id="btn-agendar"
                class="form-type-btn hover:bg-primary/10 flex-1 rounded-lg border-2 border-primary bg-transparent px-6 py-3 font-bold text-primary transition-all"
            >
                Agendar Reunión
            </button>
        </div>

        <!-- Contact Form -->
        <form id="contact-form" class="space-y-6">
            <input
                type="hidden"
                id="form-type"
                name="formType"
                value="cotizar"
            />

            <!-- Common Fields -->
            <div class="grid gap-6 md:grid-cols-2">
                <div>
                    <label for="name" class="mb-2 block font-semibold">
                        Nombre Completo <span class="text-primary">*</span>
                    </label>
                    <input
                        type="text"
                        id="name"
                        name="name"
                        required
                        class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                        placeholder="Juan Pérez"
                    />
                </div>

                <div>
                    <label for="email" class="mb-2 block font-semibold">
                        Email <span class="text-primary">*</span>
                    </label>
                    <input
                        type="email"
                        id="email"
                        name="email"
                        required
                        class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                        placeholder="juan@empresa.com"
                    />
                </div>
            </div>

            <div class="grid gap-6 md:grid-cols-2">
                <div>
                    <label for="phone" class="mb-2 block font-semibold">
                        Teléfono <span class="text-primary">*</span>
                    </label>
                    <input
                        type="tel"
                        id="phone"
                        name="phone"
                        required
                        class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                        placeholder="+505 8888-8888"
                    />
                </div>

                <div>
                    <label for="company" class="mb-2 block font-semibold">
                        Empresa
                    </label>
                    <input
                        type="text"
                        id="company"
                        name="company"
                        class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                        placeholder="Mi Empresa S.A."
                    />
                </div>
            </div>

            <!-- Cotizar Fields -->
            <div id="cotizar-fields" class="space-y-6">
                <div>
                    <label for="project-type" class="mb-2 block font-semibold">
                        Tipo de Proyecto <span class="text-primary">*</span>
                    </label>
                    <select
                        id="project-type"
                        name="projectType"
                        class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                    >
                        <option value="">Seleccione una opción</option>
                        <option value="web">Desarrollo Web</option>
                        <option value="mobile">Aplicación Móvil</option>
                        <option value="enterprise">Sistema Empresarial</option>
                        <option value="salesforce"
                            >Integración Salesforce</option
                        >
                        <option value="ecommerce">E-commerce</option>
                        <option value="other">Otro</option>
                    </select>
                </div>

                <div>
                    <label for="budget" class="mb-2 block font-semibold">
                        Presupuesto Estimado
                    </label>
                    <select
                        id="budget"
                        name="budget"
                        class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                    >
                        <option value="">Seleccione un rango</option>
                        <option value="5k-10k">$5,000 - $10,000</option>
                        <option value="10k-25k">$10,000 - $25,000</option>
                        <option value="25k-50k">$25,000 - $50,000</option>
                        <option value="50k+">$50,000+</option>
                    </select>
                </div>

                <div>
                    <label for="timeline" class="mb-2 block font-semibold">
                        Tiempo Estimado de Entrega
                    </label>
                    <select
                        id="timeline"
                        name="timeline"
                        class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                    >
                        <option value="">Seleccione un plazo</option>
                        <option value="1-month">1 mes</option>
                        <option value="1-3-months">1-3 meses</option>
                        <option value="3-6-months">3-6 meses</option>
                        <option value="6-months+">Más de 6 meses</option>
                    </select>
                </div>
            </div>

            <!-- Agendar Fields -->
            <div id="agendar-fields" class="hidden space-y-6">
                <div class="grid gap-6 md:grid-cols-2">
                    <div>
                        <label
                            for="preferred-date"
                            class="mb-2 block font-semibold"
                        >
                            Fecha Preferida <span class="text-primary">*</span>
                        </label>
                        <input
                            type="date"
                            id="preferred-date"
                            name="preferredDate"
                            class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                        />
                    </div>

                    <div>
                        <label
                            for="preferred-time"
                            class="mb-2 block font-semibold"
                        >
                            Hora Preferida <span class="text-primary">*</span>
                        </label>
                        <select
                            id="preferred-time"
                            name="preferredTime"
                            class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                        >
                            <option value="">Seleccione una hora</option>
                            <option value="9am">9:00 AM</option>
                            <option value="10am">10:00 AM</option>
                            <option value="11am">11:00 AM</option>
                            <option value="2pm">2:00 PM</option>
                            <option value="3pm">3:00 PM</option>
                            <option value="4pm">4:00 PM</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label for="meeting-type" class="mb-2 block font-semibold">
                        Tipo de Reunión <span class="text-primary">*</span>
                    </label>
                    <select
                        id="meeting-type"
                        name="meetingType"
                        class="w-full rounded-lg border-2 border-gray-300 bg-white px-4 py-3 text-neutral transition-colors focus:border-primary focus:outline-none"
                    >
                        <option value="">Seleccione una opción</option>
                        <option value="virtual">Virtual (Zoom/Meet)</option>
                        <option value="presencial">Presencial</option>
                        <option value="phone">Llamada Telefónica</option>
                    </select>
                </div>
            </div>

            <!-- Message Field (Common) -->
            <div>
                <label for="message" class="mb-2 block font-semibold">
                    Mensaje <span class="text-primary">*</span>
                </label>
                <textarea
                    id="message"
                    name="message"
                    required
                    rows="5"
                    class="w-full rounded-lg border-2 border-default bg-default px-4 py-3 text-default transition-colors focus:border-primary focus:outline-none"
                    placeholder="Cuéntanos más sobre tu proyecto o los temas que deseas discutir..."
                ></textarea>
            </div>

            <!-- Submit Button -->
            <div class="flex justify-center">
                <button
                    type="submit"
                    class="hover:bg-primary/90 rounded-lg bg-primary px-12 py-4 font-bold text-white transition-all hover:shadow-lg"
                >
                    <span id="submit-text">Enviar Cotización</span>
                </button>
            </div>
        </form>

        <!-- Success Message -->
        <div
            id="success-message"
            class="bg-primary/20 mt-6 hidden rounded-lg p-6 text-center"
        >
            <p class="font-semibold text-primary text-lg">
                ¡Gracias por contactarnos! Nos pondremos en contacto contigo
                pronto.
            </p>
        </div>
    </div>
</section>

<script is:inline>
    // Form type switching
    function initContactForm() {
        const btnCotizar = document.getElementById("btn-cotizar");
        const btnAgendar = document.getElementById("btn-agendar");
        const cotizarFields = document.getElementById("cotizar-fields");
        const agendarFields = document.getElementById("agendar-fields");
        const formTypeInput = document.getElementById("form-type");
        const submitText = document.getElementById("submit-text");

        function switchToQuote() {
            btnCotizar?.classList.add("active", "bg-primary", "text-white");
            btnCotizar?.classList.remove("bg-transparent", "text-primary");
            btnAgendar?.classList.remove("active", "bg-primary", "text-white");
            btnAgendar?.classList.add("bg-transparent", "text-primary");
            cotizarFields?.classList.remove("hidden");
            agendarFields?.classList.add("hidden");
            if (formTypeInput) formTypeInput.value = "cotizar";
            if (submitText) submitText.textContent = "Enviar Cotización";

            // Update required fields
            document
                .getElementById("project-type")
                ?.setAttribute("required", "required");
            document
                .getElementById("preferred-date")
                ?.removeAttribute("required");
            document
                .getElementById("preferred-time")
                ?.removeAttribute("required");
            document
                .getElementById("meeting-type")
                ?.removeAttribute("required");
        }

        function switchToSchedule() {
            btnAgendar?.classList.add("active", "bg-primary", "text-white");
            btnAgendar?.classList.remove("bg-transparent", "text-primary");
            btnCotizar?.classList.remove("active", "bg-primary", "text-white");
            btnCotizar?.classList.add("bg-transparent", "text-primary");
            agendarFields?.classList.remove("hidden");
            cotizarFields?.classList.add("hidden");
            if (formTypeInput) formTypeInput.value = "agendar";
            if (submitText) submitText.textContent = "Agendar Reunión";

            // Update required fields
            document
                .getElementById("project-type")
                ?.removeAttribute("required");
            document
                .getElementById("preferred-date")
                ?.setAttribute("required", "required");
            document
                .getElementById("preferred-time")
                ?.setAttribute("required", "required");
            document
                .getElementById("meeting-type")
                ?.setAttribute("required", "required");
        }

        btnCotizar?.addEventListener("click", (e) => {
            e.preventDefault();
            switchToQuote();
        });

        btnAgendar?.addEventListener("click", (e) => {
            e.preventDefault();
            switchToSchedule();
        });

        // Check URL hash on load
        if (window.location.hash === "#agendar") {
            switchToSchedule();
        } else if (window.location.hash === "#cotizar") {
            switchToQuote();
        }

        // Form submission
        const form = document.getElementById("contact-form");
        const successMessage = document.getElementById("success-message");

        form?.addEventListener("submit", async (e) => {
            e.preventDefault();

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            // Here you would normally send to a backend API
            console.log("Form data:", data);

            // Show success message
            form.classList.add("hidden");
            successMessage?.classList.remove("hidden");

            // Reset form after 3 seconds
            setTimeout(() => {
                form.reset();
                form.classList.remove("hidden");
                successMessage?.classList.add("hidden");
                switchToQuote(); // Reset to default
            }, 3000);
        });
    }

    // Run initialization when DOM is ready
    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initContactForm);
    } else {
        initContactForm();
    }
</script>

<style>
    .form-type-btn {
        cursor: pointer;
    }
</style>
